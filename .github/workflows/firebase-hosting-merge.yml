# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

# name: Deploy to Firebase Hosting on merge
# on:
#   push:
#     branches:
#       - main
# jobs:
#   build_and_deploy:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v4
#       - run: npm install && npm run build && firebase deploy
#       - uses: FirebaseExtended/action-hosting-deploy@v0
#         with:
#           repoToken: ${{ secrets.GITHUB_TOKEN }}
#           firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_COMMERCE_C123C }}
#           channelId: live
#           projectId: commerce-c123c
# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on merge
on:
  push:
    branches:
      - main
env:
  GOOGLE_API: ${{ secrets.GOOGLE_API }}
  SERVER_URL: ${{secrets.SERVER_URL}}
  REACT_APP_SERVER_URL: ${{secrets.REACT_APP_SERVER_URL}}
  PAYPAL_CLIENT_ID: ${{secrets.PAYPAL_CLIENT_ID}}
  PAYPAL_SECRET: ${{secrets.PAYPAL_SECRET}}
  PAYSTACK_PUBLIC_KEY: ${{secrets.PAYSTACK_PUBLIC_KEY}}
  MAPTILER_API_KEY: ${{secrets.MAPTILER_API_KEY}}
  GOOGLE_GEOCODING_API: ${{secrets.GOOGLE_GEOCODING_API}}
  FIREBASE_API_KEY: ${{secrets.FIREBASE_API_KEY}}
jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Check out the code
      - uses: actions/checkout@v4

      # Step 2: Set up Node.js (use at least v18)
      - uses: actions/setup-node@v3
        with:
          node-version: 20

      # Step 3: Install dependencies and build the project
      - run: npm install
      - run: npm run build

      # Step 4: Deploy to Firebase Hosting
      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: ${{ secrets.GITHUB_TOKEN }}
          firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_COMMERCE_C123C }}
          channelId: live
          projectId: allanabere-bd579